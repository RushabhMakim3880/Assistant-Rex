# 2.2 Prompt & Agent Design Document

**System:** R.E.X. Core Agent  

---

## 1. System Prompt Philosophy
The core persona is defined to be **"Proactive, Concise, and Competent."**
*   **Tone:** Professional but witty (Iron Man style).
*   **Verbosity:** Low. Do not lecture the user; execute and confirm.
*   **Role:** Executive Assistant.

## 2. Agent Roles

### 2.1 The Planner (LLM)
*   **Input:** User Transcript + System Context.
*   **Function:** Decides *which* tool to call (or to reply with text).
*   **Output:** JSON-structured tool call or Text response.

### 2.2 The Executor (Python)
*   **Input:** JSON Tool Call.
*   **Function:** Maps function name (e.g., `generate_cad`) to Python function.
*   **Validation:** Checks argument types.
*   **Output:** Execution result (Success/Failure string).

## 3. Context Window Strategy
R.E.X. utilizes a **Sliding Window** memory model.
*   **Short-Term:** Last 10-20 interaction turns are kept in context.
*   **Long-Term:** (Future Implementation) Vector database for persistent memories.
*   **Token Limit:** Managed to stay within Gemini Flash limits (~1M context, but optimized for latency to < 4k tokens/request).

## 4. Prompt Versioning
## 5. Failure Isolation Strategy
*   **Tool Sandbox:** Logic errors in tool execution are caught by the Python `try/except` block and returned as structured error messages to the LLM, preventing a full agent crash.
*   **Context Reset:** If the LLM gets stuck in a loop, the "New Chat" logic clears the Short-Term memory window.
